var t=this&&this.__extends||function(){var t=function(e,a){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])},t(e,a)};return function(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function r(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),a=this&&this.__awaiter||function(t,e,a,r){return new(a||(a=Promise))((function(n,l){function o(t){try{s(r.next(t))}catch(t){l(t)}}function i(t){try{s(r.throw(t))}catch(t){l(t)}}function s(t){var e;t.done?n(t.value):new a((function(e){e(t.value)})).then(o,i)}s((r=r.apply(t,e||[])).next())}))},l=this&&this.__generator||function(t,e){var a,r,l,n,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return n={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),n;function i(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,r&&(l=2&t[0]?r.return:t[0]?r.throw||((l=r.return)&&l.call(n),0):r.next)&&!(l=l.call(r,t[1])).done)return l;switch(r=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return o.label++,{value:t[1],done:!1};case 5:o.label++,r=t[1],t=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(l=o.trys,l=l.length>0&&l[l.length-1])&&(6===t[0]||2===t[0])){o=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){o.label=t[1];break}if(6===t[0]&&o.label<l[1]){o.label=l[1],l=t;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(t);break}l[2]&&o.ops.pop(),o.trys.pop();continue}t=e.call(t,o)}catch(t){t=[6,t],r=0}finally{a=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("cheerio"),n=require("@libs/fetch"),o=require("@libs/novelStatus"),i=function(){function e(){this.id="novelbin_pt",this.name="Novel Bin Tradução",this.icon="icons/english/novelbin.png",this.site="https://novelbin-com.translate.goog/?_x_tr_sl=en&_x_tr_tl=pt&_x_tr_hl=pt-BR&_x_tr_pto=wapp",this.version="1.1.0"}return e.prototype.getCheerio=function(e){return a(this,void 0,void 0,(function(){var t;return l(this,(function(a){switch(a.label){case 0:return[4,(0,n.fetchApi)(e)];case 1:return t=a.sent(),[2,r.load(t.body)]}}))}))},e.prototype.popularNovels=function(e,t){return a(this,void 0,void 0,(function(){var r,n,o,i,s=this;return l(this,(function(l){switch(l.label){case 0:return r=this.site+"sort/popular-novel?page="+e,[4,this.getCheerio(r)];case 1:return n=l.sent(),o=n(".list-novel .row").map((function(e,t){var a=s(t),r=a.find(".novel-title a").text().trim(),n=a.find(".novel-title a").attr("href"),o=a.find("img").attr("data-src")||a.find("img").attr("src");return{name:r,cover:o,path:n.replace(s.site,"")}})).get(),[2,o]}}))}))},e.prototype.parseNovel=function(e){return a(this,void 0,void 0,(function(){var t,r,n,i,s,c,v=this;return l(this,(function(l){switch(l.label){case 0:return t=this.site+e,[4,this.getCheerio(t)];case 1:return r=l.sent(),n={path:e,name:r("h3.title").text().trim()},n.cover=r(".book img").attr("src"),n.summary=r(".desc-text").text().trim(),n.author=r(".info div:contains('Author:') a").text().trim(),i=r(".info div:contains('Status:') a").text().trim().toLowerCase(),n.status=i.includes("completed")?o.NovelStatus.Completed:o.NovelStatus.Ongoing,s=[],r("ul.list-chapter li a").each((function(e,t){var a=v(t);s.push({name:a.find(".chapter-text").text().trim(),path:a.attr("href").replace(v.site,"")})})),n.chapters=s,[2,n]}}))}))},e.prototype.parseChapter=function(e){return a(this,void 0,void 0,(function(){var t,r,n;return l(this,(function(l){switch(l.label){case 0:return t=this.site+e,[4,this.getCheerio(t)];case 1:return r=l.sent(),n=r("#chr-content").html()||r(".chapter-c").html(),[2,n]}}))}))},e.prototype.searchNovels=function(e,t){return a(this,void 0,void 0,(function(){var r,n,o,i=this;return l(this,(function(l){switch(l.label){case 0:return r=this.site+"search?keyword="+encodeURIComponent(e),[4,this.getCheerio(r)];case 1:return n=l.sent(),o=n(".list-novel .row").map((function(e,t){var a=i(t),r=a.find(".novel-title a").text().trim(),n=a.find(".novel-title a").attr("href"),o=a.find("img").attr("data-src")||a.find("img").attr("src");return{name:r,cover:o,path:n.replace(i.site,"")}})).get(),[2,o]}}))}))},e}();exports.default=new i;
